<script type="text/javascript">

/**
 * 楠岃瘉鐢ㄦ埛鍚嶆槸鍚﹀瓨鍦�
 * @param userName
 */
function valiUserName(userName){
	var result = ajaxFunc("/jf/platform/login/valiUserName", {"userName" : userName});
	return result;
}

/**
 * 楠岃瘉閭鏄惁瀛樺湪
 * @param mailBox
 */
function valiMailBox(mailBox){
	var result = ajaxFunc("/jf/platform/login/valiMailBox", {"mailBox" : mailBox});
	return result;
}

/**
 * 楠岃瘉韬唤璇佹槸鍚﹀瓨鍦�
 * @param idcard
 */
function valiIdcard(idcard){
	var result = ajaxFunc("/jf/platform/login/valiIdcard", {"idcard" : idcard});
	return result;
}

/**
 *楠岃瘉鎵嬫満鍙锋槸鍚﹀瓨鍦�
 * @param mailBox
 */
function valiMobile(mobile){
	var result = ajaxFunc("/jf/platform/login/valiMobile", {"mobile" : mobile});
	return result;
}

function dataVali(form){
	var usernameId = $("#usernameId").val();
	var mailboxId = $("#mailboxId").val();
	var idcardId = $("#idcardId").val();
	var mobileId = $("#mobileId").val();
	
	var isAdd = ${operatorType == "add" ? "true" : "false"};
	if(isAdd){ // 娣诲姞
		if(idcardId != "" && valiIdcard(idcardId) != "0"){
			simpleDialog('楠岃瘉鎻愮ず', '韬唤璇佸彿鐮侀噸澶嶏紒');
	 		return false;
		}
	
		if(usernameId != "" && valiUserName(usernameId) != "0"){
			simpleDialog('楠岃瘉鎻愮ず', '璐﹀彿閲嶅锛�);
	 		return false;
		}
	
		if(mailboxId != "" && valiMailBox(mailboxId) != "0"){
			simpleDialog('楠岃瘉鎻愮ず', '閭閲嶅锛�);
	 		return false;
		}

		if(mobileId != "" && valiMobile(mobileId) != "0"){
			simpleDialog('楠岃瘉鎻愮ず', '鎵嬫満鍙风爜閲嶅锛�);
	 		return false;
		}
	
	}else{ // 鏇存柊
		if(idcardId != "" && valiIdcard(idcardId) != "0" && valiIdcard(idcardId) != "1"){
			simpleDialog('楠岃瘉鎻愮ず', '韬唤璇佸彿鐮侀噸澶嶏紒');
	 		return false;
		}
	
		if(usernameId != "" && valiUserName(usernameId) != "0" && valiUserName(usernameId) != "1"){
			simpleDialog('楠岃瘉鎻愮ず', '璐﹀彿閲嶅锛�);
	 		return false;
		}
	
		if(mailboxId != "" && valiMailBox(mailboxId) != "0" && valiMailBox(mailboxId) != "1"){
			simpleDialog('楠岃瘉鎻愮ず', '閭閲嶅锛�);
	 		return false;
		}

		if(mobileId != "" && valiMobile(mobileId) != "0" && valiMobile(mobileId) != "1"){
			simpleDialog('楠岃瘉鎻愮ず', '鎵嬫満鍙风爜閲嶅锛�);
	 		return false;
		}
	}
	
	var pass1Id = $("#pass1Id").val();
	var pass2Id = $("#pass2Id").val();
	if(pass1Id != pass2Id){
		simpleDialog('楠岃瘉鎻愮ず', '涓ゆ杈撳叆瀵嗙爜涓嶄竴鑷达紝璇蜂粠鏂拌緭鍏ワ紒');
 		return false;
	}
	
	var errorCount = formVali(form);
	if(errorCount != 0){
		simpleDialog('楠岃瘉鎻愮ず', '鏈�+errorCount+'澶勯敊璇紝璇蜂慨姝ｏ紒');
 		return false;
	}
	
	ajaxForm("content", "editForm");
}

</script>

<fieldset>
	<div class="control-group">
		<label class="control-label">${i18nMap["admin.user.property.department"]}</label>
		<div class="controls">
			<input type="hidden" id="deptId" name="user.departmentids" value="${escapeXml(user.departmentids!)}"/>
			<input type="text" id="deptName" name="user.departmentnames" value="${escapeXml(user.departmentnames!)}" 
				class="input-xlarge focused" readonly="readonly" maxlength="100" vMin="1" vType="length" onblur="onblurVali(this);">
			<button class="btn" type="button" onclick="deptRadioDiaLog('deptId', 'deptName', '${escapeXml(user.departmentids!)}');">${i18nMap["admin.common.choice"]}</button>
			<span class="help-inline"></span>
		</div>
	</div>
	<div class="control-group">
		<label class="control-label">${i18nMap["admin.user.property.station"]}</label>
		<div class="controls">
			<input type="hidden" id="stationId" name="user.stationids" value="${escapeXml(user.stationids!)}"/>
			<input type="text" id="stationName" name="user.stationnames" value="${escapeXml(user.stationnames!)}" 
				class="input-xlarge" readonly="readonly" maxlength="100" vMin="1" vType="length" onblur="onblurVali(this);">
			<button class="btn" type="button" onclick="stationRadioDiaLog('stationId', 'stationName', '${escapeXml(user.stationids!)}');">${i18nMap["admin.common.choice"]}</button>
			<span class="help-inline"></span>
		</div>
	</div>
	<div class="control-group">
		<label class="control-label">${i18nMap["admin.user.property.dataAccess"]}</label>
		<div class="controls">
			<input type="hidden" id="deptId2" name="user.deptids" value="${escapeXml(user.deptids!)}" />
			<input type="hidden" id="deptName2" name="user.deptnames" value="${escapeXml(user.deptnames!)}" />
			
			<input type="hidden" id="userId" name="user.userids" value="${escapeXml(user.userids!)}" />
			<input type="text" id="userName" name="user.usernames" value="${escapeXml(user.usernames!)}" 
				class="input-xlarge" readonly="readonly" maxlength="10000" vMin="1" vType="length" onblur="onblurVali(this);">
			
			<button class="btn" type="button" onclick="userCheckboxDiaLog('userId', 'userName', 'deptId2', 'deptName2', '${escapeXml(user.deptids!)}', '${escapeXml(user.userids!)}');">${i18nMap["admin.common.choice"]}</button>
			<span class="help-inline"></span>
		</div>
	</div>
	<div class="control-group">
		<label class="control-label">${i18nMap["admin.user.property.idcard"]}</label>
		<div class="controls">
			<input type="text" id="idcardId" name="userInfo.idcard" value="${escapeXml(userInfo.idcard!)}" 
				class="input-xlarge" maxlength="18" vMin="15" vType="idCard" onblur="onblurVali(this);">
			<span class="help-inline">15-18浣嶅瓧姣嶆暟瀛�/span>
		</div>
	</div>
	<div class="control-group">
		<label class="control-label">${i18nMap["admin.user.property.nickname"]}</label>
		<div class="controls">
			<input type="text" name="userInfo.names" value="${escapeXml(userInfo.names!)}" 
				class="input-xlarge" maxlength="10" vMin="2" vType="length" onblur="onblurVali(this);">
			<span class="help-inline">2-10浣嶄换鎰忓瓧绗�/span>
		</div>
	</div>
	<div class="control-group">
		<label class="control-label">${i18nMap["admin.user.property.userName"]}</label>
		<div class="controls">
			<input type="text" id="usernameId" name="user.username" value="${escapeXml(user.username!)}" 
				class="input-xlarge" maxlength="16" vMin="5" vType="letterNumber" onblur="onblurVali(this);">
			<span class="help-inline">5-16浣嶅瓧姣嶆暟瀛�/span>
		</div>
	</div>
	<div class="control-group">
		<label class="control-label">${i18nMap["admin.user.property.password"]}</label>
		<div class="controls">
			<input type="password" id="pass1Id" name="password" class="input-xlarge" autocomplete="off"
				maxlength="18" vMin='<%if(operatorType == "add"){print("6");}else{print("0");}%>' vType="letterNumber" onblur="onblurVali(this);">
			<span class="help-inline">6-18浣嶅瓧姣嶆暟瀛�/span>
		</div>
	</div>
	<div class="control-group">
		<label class="control-label">${i18nMap["admin.user.property.password"]}</label>
		<div class="controls">
			<input type="password" id="pass2Id" class="input-xlarge" autocomplete="off"
				maxlength="18" vMin='<%if(operatorType == "add"){print("6");}else{print("0");}%>' vType="letterNumber" onblur="onblurVali(this);">
			<span class="help-inline">6-18浣嶅瓧姣嶆暟瀛�/span>
		</div>
	</div>
	<div class="control-group">
		<label class="control-label">${i18nMap["admin.user.property.email"]}</label>
		<div class="controls">
			<input type="text" id="mailboxId" name="userInfo.email" value="${escapeXml(userInfo.email!)}" 
				class="input-xlarge" maxlength="30" vMin="6" vType="email" onblur="onblurVali(this);">
			<span class="help-inline">6-30浣嶉偖绠辫鍒�/span>
		</div>
	</div>
	<div class="control-group">
		<label class="control-label">${i18nMap["admin.user.property.mobilePhone"]}</label>
		<div class="controls">
			<input type="text" id="mobileId" name="userInfo.mobile" value="${escapeXml(userInfo.mobile!)}" 
				class="input-xlarge" maxlength="11" vMin="11" vType="phone" onblur="onblurVali(this);">
			<span class="help-inline">11浣嶆暟瀛�/span>
		</div>
	</div>
	<div class="control-group">
		<label class="control-label">${i18nMap["admin.user.property.telephone"]}</label>
		<div class="controls">
			<input type="text" name="userInfo.telephone" value="${escapeXml(userInfo.telephone!)}" 
				class="input-xlarge" maxlength="20" vMin="0" vType="tell" onblur="onblurVali(this);">
			<span class="help-inline">5-20浣�/span>
		</div>
	</div>
	<div class="control-group">
		<label class="control-label">${i18nMap["admin.user.property.qq"]}</label>
		<div class="controls">
			<input type="text" name="userInfo.qq" value="${escapeXml(userInfo.qq!)}" 
				class="input-xlarge" maxlength="20" vMin="0" vType="qq" onblur="onblurVali(this);">
			<span class="help-inline">5-20浣嶆暟瀛�/span>
		</div>
	</div>
	<div class="control-group">
		<label class="control-label">${i18nMap["admin.user.property.birthday"]}</label>
		<div class="controls">
			<input type="text" name="userInfo.birthday" readonly="readonly"
				value='${userInfo.birthday!, dateFormat="yyyy-MM-dd"}' 
				class="input-xlarge datepicker" maxlength="11" vMin="0" vType="length" onblur="onblurVali(this);">
			<span class="help-inline">yyyy骞磎m鏈坉d鏃�/span>
		</div>
	</div>
</fieldset>